#!/bin/bash
unset checkPID_GEN
checkPID_GEN=$(ps x|grep -w "8888"|grep -v grep)
[[ ! $checkPID_GEN ]] && PID_GEN=' Fail âŒ' || PID_GEN=' Check âœ…'
[[ -e /etc/systemd/system/btkill.service ]] && kkid=" âœ…" || kkid=" âŒ"
[[ -e /root/RegBOT/IGlobal ]] && _TopGlobal=$(cat < /root/RegBOT/IGlobal) || _TopGlobal='âŒ - âŒ'

call.terminos() {
MSG_id=$((${message_message_id} + 1 ))
[[ -z ${callback_query_from_username} ]] && nUSER=${message_from_username} || nUSER=${callback_query_from_username}
local SMS=$(curl -sSL "https://raw.githubusercontent.com/Qm90R2VuIDIwMjQgQ2h1bW9HSCsK/U291cmNlIEJvckdlbiBBRE1jZ2ggQ2h1bW9HSCAyMDI0IFBsdXM-/main/source/terminos.txt") 
	bot_retorno=" =============================================\n"
	bot_retorno+="  ${SMS}"
	bot_retorno+=" =============================================\n"
msj_fun
sleep 10s
msj_del ${message_message_id}
msj_del ${MSG_id}
}

calcular_tiempo() {
dias=$1
DS="DIA'(s)"
SM="SEMANA'(s)"
MS="MES'(s)"
AS="AÃ‘O'(s)"

    if (( $dias == 7 )); then
        echo "1 SEMANA"
    elif (( $dias == 14 )); then
        diasBOT="2 ${SM}"
    elif (( $dias == 21 )); then
        diasBOT="3 ${SM}"
	elif (( $dias == 30 )); then
        diasBOT="4 ${SM}"
    elif (( $dias > 30 && $dias <= 37 )); then
        diasBOT="1 ${MS}, 1 ${SM}"
    elif (( $dias > 37 && $dias <= 60 )); then
        diasBOT="2 ${MS}"
    elif (( $dias > 60 && $dias <= 90 )); then
        diasBOT="3 ${MS}"
    elif (( $dias > 90 && $dias <= 365 )); then
        meses=$(( $dias / 30 ))
		diasBOT="$meses ${MS}"
    elif (( $dias > 365 )); then
        anios=$(( $dias / 365 ))
		diasBOT="$anios ${AS}"
    else
        diasBOT="$dias ${DS}"
    fi
}

menu_src () {
local _fecha=`date +%d-%m-%y`
local _hora=$(date +"%H:%M:%S") 
#namcli=$(bash /etc/ADM-db/BotGen.sh | grep  message_from_first_name | grep message_from_first_name | grep -i message_from_first_name | awk {'print $4'})
#${message_text[$usuario]}  $message_from_first_name $message_from_last_name
[[ -z ${callback_query_from_username} ]] && nUSER=${message_from_username} || nUSER=${callback_query_from_username}
bot_retorno="  âœ¨ BIENVENIDO A ADMcgh/ChumoGH($(cat < /etc/SCRIPT/v-local.log)) âœ¨\n"
	 if [[ $(echo $permited|grep "${chatuser}") = "" ]]; then
		 if [[ $(cat ${CID}|grep "${chatuser}") = "" ]]; then
		 [[ -z $(cat /root/RegBOT/banID | grep -w ${chatuser}) ]] && {
		 #[[ -z "$(echo -e "${idBAN}" | grep -w "${chatuser}")" ]] && {
		 	 bot_retorno+=" â”€â”€â”€â”€ Â· Â· Â· â”€â”€â”€â”€ ê’° ê’± â”€â”€â”€â”€ Â· Â· Â· â”€â”€â”€â”€ \n"
			 bot_retorno+="  TOTAL DE INSTALL GLOBALES ( ${_TopGlobal} ) âœ¨\n"
		 	 bot_retorno+=" =============================================\n"
			 bot_retorno+="  SU ğŸ†” : <code>${chatuser}</code> NO ESTA AUTORIZADO ğŸš«"
			 bot_retorno+=" =============================================\n"
			 bot_retorno+=" | â° HORA : ${_hora} - | - ğŸ“… FECHA : ${_fecha} \n"
			 bot_retorno+=" | HOLA @${nUSER} UD NO ESTA AUTORIZADO \n"
			 bot_retorno+=" | SELECCIONA UN OPCION DE ABAJO !!!    \n"
			 bot_retorno+=" =============================================\n"
			 bot_retorno+=" RECLAMAR/CANJEAR CUPON /cupon \n"
			 bot_retorno+=" =============================================\n"
			 bot_retorno+=" âš•ï¸ APLICA TERMINOS Y CONDICIONES! /termâš•ï¸ \n"
			 bot_retorno+=" =============================================\n"
			 menu_printSN
			 } || invalido_fun
		#	 menu_printSN
			 #msj_fun
		 else
		 	[[ -e /etc/menu_ito ]] && nomkey="$(cat /etc/menu_ito)" || nomkey='@ChumoGH - OFFICIAL'
		 	numkey_used=$(grep -o -i $message_chat_id /etc/gerar-sh-log | wc -l)
			numkey_gen=$(grep -o -i $message_chat_id /etc/ADM-db/num-key.cont | wc -l)
			data_user=$(cat ${CID}|grep "${chatuser}" | awk -F "|" '{print $2}')
			data_sec=$(date +%s)
			data_user_sec=$(date +%s --date="$data_user")
			variavel_soma=$(($data_user_sec - $data_sec))
			dias_use=$(($variavel_soma / 86400))
			[[ "$dias_use" -le 0 ]] && dias_use=0 || dias_use=$(($dias_use + 1))
			calcular_tiempo $dias_use
			bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
			 bot_retorno+=" ğŸ”¥ TIENE ACCESO POR ${diasBOT} ğŸ”¥ \n" #  âœ“ INCLUIDO TU RESELLER EN LA KEY âœ”\n"
			 bot_retorno+=" âœ© AUTORIZACION VALIDA HASTA $data_user âŒš\n" #$(date +%R)
			 [[ -z $checkPID_GEN ]] && bot_retorno+=" âš ï¸ ADVERTENCIA!! SerFTP COLAPZADO âš ï¸\n" || bot_retorno+="  SerFTP ğŸŒ Enlace Conectado ğŸ”—\n"
			 [[ -z ${callback_query_from_first_name} ]] && firsnme="${message_from_first_name}" || firsnme="${callback_query_from_first_name}"
			 [[ -z ${callback_query_from_last_name} ]] && lastnme="${message_from_last_name}" || lastnme="${callback_query_from_last_name}"
			 bot_retorno+=" | â° HORA : ${_hora} - | - ğŸ“… FECHA : ${_fecha} \n"
			 bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
			 bot_retorno+=" RESELLER ACTUAL : ${firsnme} ${lastnme}\n"
			 bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
			 bot_retorno+=" MENU DEL BOTâ–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–º /menu  \n"
			 bot_retorno+=" LINK DE SCRIPTâ–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–º /instal \n"
			 #bot_retorno+=" INSTALL REMOTOâ–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–º /remote \n"
			 bot_retorno+=" GENERAR KEY ChumoGHâ–¬â–¬â–¬â–¬â–º /keygen\n"
[[ $(cat ${CID} | grep -w ${nombrevalue} | cut -d '|' -f3) = "true" ]] && bot_retorno+=" GENERAR LATAM (BETA)â–¬â–¬â–¬â–º /kltm  \n"
			 bot_retorno+=" INSTRUCCIONES DEL BOTâ–¬â–¬â–º /ayuda \n"
			 bot_retorno+=" REINCIAR HUESPED DE BOTâ–¬â–¬â–º /restart \n"
			 bot_retorno+=" ADD DOMAIN CLOUDFLAREâ–¬â–¬â–º /domainA /domainNS\n"
			 bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
			 bot_retorno+="  TOTAL DE INSTALL GLOBALES ( ${_TopGlobal} ) âœ¨\n"
			 #bot_retorno+=" âŠ ğšğšğšŒğšğšğš›ğšğšŠ ğ™²ğš˜ğš•ğšŠğš‹ğš˜ğš›ğšŠğš› ğŸ’¸ğŸ’° , ğšœğš’ ğšğš ğšŠğšğš›ğšŠğšğš˜ ğš–ğš’ ğšƒğš›ğšŠğš‹ğšŠğš“ğš˜ âŠ\n"
			 bot_retorno+=" Inconvenientes con el Bot Contactame : +$(cat < /etc/numctc) ğŸ“²\n"
			 bot_retorno+=" ğŸ” ã€ $numkey_used ã€ğ™†ğ™šğ™®ğ™¨ ğ™ğ™¨ğ™–ğ™™ğ™–ğ™¨ ğŸ”“,ã€ $numkey_gen ã€ğ™†ğ™šğ™®ğ™¨ ğ™‚ğ™šğ™£ğ™šğ™§ğ™–ğ™™ğ™–ğ™¨ ğŸ—ï¸ \n"
			 bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
			 menu_print
		 fi
		 
	 else
		 unset usadas
		 usadas="$(cat /etc/http-instas)"
		 [[ ! $usadas ]] && k_used="0" || k_used="${usadas}"
		 bot_retorno+=" | GENERADOR WEB FILE : ${PID_GEN} \n"
		 bot_retorno+=" | â° HORA : ${_hora} - | - ğŸ“… FECHA : ${_fecha} \n"
		 bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
		 bot_retorno+="  TOTAL DE INSTALL GLOBALES ( ${_TopGlobal} ) âœ¨\n"
		 bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
		 #bot_retorno+="/infosys	>> 	INFORMACION DEL VPS \n"
		 #bot_retorno+="/killid	>> 	LIMITADOR DE CADUCIDAD ${kkid}\n"
		 #bot_retorno+="/idgen	>> 	LISTA DE ID + GENERADAS\n"
		 bot_retorno+="/banID	>> 	BANEAR ID PARA EL BOT\n"
		 bot_retorno+="/Uban	>> 	DESBANEAR ID PARA EL BOT\n"
		 bot_retorno+="/chat	>> 	MENSAJE PERSONAL A ID\n"
		 bot_retorno+="/buscar	>> 	BUSCAR ID AUTORIZADO\n"
		 bot_retorno+="/kltm	>> 	Key SCRIPT LATAM \n"
		 #bot_retorno+="/addrev	>> 	AÃ‘ADIR UN REVENDEDOR \n"
		 bot_retorno+="/ayuda	>>	INSTRUCCIONES DE COMANDOS \n"
		 bot_retorno+="/cache	>>	OPTIMIZA SERVIDOR \n"
		 bot_retorno+="/update	>>	ACTUALIZA FILES BotGen \n"
		 bot_retorno+="/reboot	>>	REINICIA SERVIDOR VPS \n"
		 bot_retorno+="/Cprecios   >> CAMBIAR PRECIOS DE BOT\n"
		 bot_retorno+="/ccupon   >> CREAR CUPON PARA CANJEAR\n"
		 #bot_retorno+="/donar	>> ACTIVA O DESACTIVA EL MENSAJE DONATIVO \n"
		 bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
		 bot_retorno+=" ADD DOMAIN CLOUDFLARE--â–º /domainA /domainNS\n"
		 bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
		 menu_print
		 #bot_retorno=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
		 #bot_retorno+=" AÃ‘ADIR REVENDEDORES [ FUNCION BETA ]\n"
		 #bot_retorno+=" â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ \n"
		 #call.botonADDrev
	 fi	
}
